Supporting data and code for the main analyses reported in:

M.A.Just, L.Pan, V.L.Cherkassky, D.L.McMakin, C.Cha, M.K.Nock,D.Brent
Machine learning of neural representations of suicide and emotion concepts identifies suicidal youth.
Nature Human Behaviour (2017) doi:10.1038/s41562-017-0234-y

****** Data files and structures

Location: data/adjMpsc/<subj>_avgMpsc.mat, where subj is the MRI ID of each of the 34 participants
Variables:
  common       24547x3            
  avgC            30x3        
  avgMpsc         30x24547            
  stab30           1x24547
common:  a list of 24547 voxel coordinates (x y z)(in MNI space, 3.125x3.125x6 mm voxels, 50x61x23 voxels) that was 
         defined as an intersection of voxels present in the scans of all 34 participants.              
avgMpsc: represents a 30 words by 24547 voxels matrix of activation levels (converted to % signal change
         from fixation and averaged across all presentations of a set of 30 words). The columns in avgMpsc match 
         the rows in the 'common' variable.
avgC:    a matrix that describes each row of avgMpsc. The informative columns are 1 and 2, the first column define the
         category of a word (2: suicide; 3: positive, 4: negative), the second column is the exemplar number 
         (1 through 10) within the category. To obtain the absolute word numbers, use (C(:,1)-2)*10+C(:,2).
stab30:  a vector of stability scores computed for each voxel.

Location: data/words.mat
Variables:
   words      30x1 cell
30 words (sorted by their absolute number) used in the experiment.

Location: data/common_info.mat
Variables:
  aff_subj         17x1 cell                
  con_subj         17x1 cell                
  common        24547x3          
Lists of MRI IDs of affected (aff_subj) and control (con_subj) subjects.
common: a list of 24547 voxel coordinates that are present in all 34 subjects 
        (same as in data/adjMpsc/<subj>_avgMpsc.mat).

Location: data/aff_stabLocations.mat, data/con_stabLocations.mat
The structures describing clusters of stable voxels for the two groups.
Variables:
  clusters       1 x nclust structure with important fields:
    xyz_cluster
    nuvox
    label
    centroid
    radius

Each cluster is specified by a list of its voxels (xyz_cluster), number of voxels (nuvox), 
anatomical label, centroid, and radius (in mm in MNI space).

Location: data/aff_stabLocations[1:17].mat, data/con_stabLocations[1:17].mat
The structures describing pre-selected (according to configuration file in code directory) 
clusters of stable voxels computed using 16 of 17 participants in each group.
E.g., the data in the file aff_stabLocations1.mat was computed using affected subjects 2...17
The variables in these files are similar to the variables in the full-group files, like aff_stabLocations.mat.

Location: data/regression_weights.txt
Regression weights of 4 emotions (sadness, shame, anger, and pride) computed for 6 discriminative concepts
(death, carefree, good, cruelty, praise, and trouble) for the 34 participants.
The structure and values in this text file are the same as reported in the paper 
(see Supplementary Methods, section "Classification based on emotional content of neural signatures")

****** Custom code

The Matlab code is located in the 'code' directory and includes a set of functions necessary 
to perform the main analyses reported in the paper. The main function to use is group_membership.m. 
The configuration.m specifies a number of parameters and data sources used in the analysis.
Executing the function group_membership('configuration') results in the 91% accurate group membership 
classification.

Shown below is the output generated by the command:
>> [meanacc,full_acc] = group_membership('configuration'); 
Aff subj: 01111111111101111
Con subj: 11111111111110111
Mean group membership classification accuracy: 0.91

The function uses the clusters of stable voxels pre-computed for each of the full groups
and for each of the 34 leave-one-subject-out cross-validation folds. These clusters can be re-created
using the provided data (stab30 variables for all participants).

To perform the group membership classification based on the emotional content of neural signatures,
the function group_membership_emotions.m can be used.
Executing the function group_membership_emotions() results in the 85% accurate group membership 
classification.

Shown below is the output generated by the command:
>> group_membership_emotions;
Aff subj: 11100111111101111
Con subj: 11111110111110111
Mean group membership classification accuracy: 0.85

The functions trainClassifier.m, classifierBayes.m, and applyClassifier.m are included here for convenience
and are the components of the ML package developed at CMU Machine Learning Department 
(http://www.cs.cmu.edu/afs/cs.cmu.edu/project/theo-81/www/fmri_core.zip) 

****** Code prerequisites

The analysis was performed under Linux OS (SUSE) using Matlab R2014a (base version + statistics toolbox)
The supplied code does not require any other additional toolboxes; to generate brain images
and/or perform additional brain location analyses, SPM8 ((http://www.fil.ion.ucl.ac.uk/spm/software/spm8/) 
package with AAL toolbox (http://www.gin.cnrs.fr/en/tools/aal-aal2/) might be needed.


